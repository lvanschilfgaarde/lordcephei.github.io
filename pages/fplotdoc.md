---
layout: page-fullwidth
title: "The fplot program"
permalink: "/docs/misc/fplot/"
header: no
---
_____________________________________________________________


### _Purpose_
{:.no_toc}

**fplot**{: style="color: blue"} is a general purpose plotting package, with functionality similar to **gnuplot**{: style="color: blue"}.
It is provided here because the tool synchronises smoothly with the rest of the Questaal codes such as **plbnds**{: style="color: blue"}
and **pldos**{: style="color: blue"}.  

For standard functions such as plotting bands or densities-of-states, tutorials use **gnuplot**{: style="color: blue"} or **fplot**{: style="color: blue"};

For some purposees **fplot**{: style="color: blue"} provides some functionality not readily obtained in **gnuplot**{: style="color: blue"}, e.g.
to determine cyclotron masses, plotting bands with color weights, and using the programming language features of the Questaal suite.

_____________________________________________________________

### _Table of Contents_
{:.no_toc}
*  Auto generated table of contents
{:toc}  

### 1. _Preliminaries_

It is assumed that you have **fplot**{: style="color: blue"} in your path.  You will need some capability to display postscript files.

**fplot**{: style="color: blue"} generates a postscript file _fplot.ps_{: style="color: green"}.

_____________________________________________________________

### 2. _Introduction_

**fplot**{: style="color: blue"} is mainly designed to draw _xy_ data; it has some capability for contour plots and a very limited ability
for 3D graphics.

**fplot**{: style="color: blue"} is command-line driven and can efficiently generate figures from command-line arguments.  It can also read
arguments from a file script; this is necessary if the figure is complex.  **fplot**{: style="color: blue"} can make full use of the programming
language capability it has for reading input files, both in the script and in data files.

Other programs, especially **plbnd**{: style="color: blue"} and **pldos**{: style="color: blue"}, make **fplot**{: style="color: blue"}
script to make the process of drawing bands and figures very easy and efficient, with the capability of refining the figure by tuning the
autogenerated plotting script.

### 3. _Examples_

Section 4 explains the commands **fplot**{: style="color: blue"} will accept.

This section develops a couple of examples to give you an intuitive feel of how the code operates and to set many of the settings you
typically want to control yourself.

#### Example 3.1. &nbsp; plot $$y=20\,x^2\exp(-4x)$$

The following will plot this function in the interval (0,2), with the abscissa spaced in intervals of 0.02:

    $ fplot -ord '20*x^2*exp(-4*x)' -tp .02:2:.02
    $ open fplot.ps 

<div onclick="elm = document.getElementById('fig1'); if(elm.style.display == 'none') elm.style.display = 'block'; else elm.style.display = 'none';">Click here to see the figure.</div>
{::nomarkdown}<div style="display:none;padding:0px;" id="fig1">{:/} 
![Example 3.1](https://lordcephei.github.io/assets/img/fplot1.svg)
{::nomarkdown}</div>{:/}

Some useful points to note:

+ A square box is drawn around the figure.  You can select the width and height of the box; see `-frme` below, or try  
  `fplot -frme .1,.9,.3,.7 -ord ...`
+ For log scales modify `-frme` with `:lx` or `:ly` or both, e.g.  
  `fplot -frme:ly 0,1,0,1 -ord ...`
+ By default all four edges of the box are drawn.  You can draw any combination of the four (`-frmt`) or shade the box; e.g.  
  `fplot -frmt th=6,1,1 -ord ...`  or  `fplot -frmt col=.8,.9,.9,th=0 -ord ...`
+ You can also draw the abscissa and ordinate through some middle point (`-frme:xor` and `-frme:yab`), e.g.  
  `fplot -frme:xor=.5:yab=.675 0,1,0,1 -ord ...`
+ You have considerable flexibility in controlling major and minor tic marks on the abscissa and ordinate (`-tmx` and `-tmy`), e.g.  
  `fplot -tmx '.25;1~.02' -tmy '.1:5' -ord ...`
+ There is considerable flexibility in controlling the tic mark numbering, font (`-font`) 
  and format (`-fmtnx` and `-fmtny`) of the numbers, whether they are suppressed (`-noxn` and `-noyn`) and where they are placed (`-xn` and `-yn`)  
  `fplot '-fmtnx:%;2,2d' -fmtny:%e -ord ...`
+ You can control many aspects of the line type (`-lt`), e.g.  
  `fplot -lt 3,bold=4,col=1,0,0 -ord ...`
+ The abscissa ranges from -0.1 to 2.1; the ordinate from -0.033 to +0.71. They were found automatically by finding the largest and smallest
  values in the frame, and padding the range by 10%.  You can specify the padding (`-pad`) and/or the bounds (`-x` and `-y`), e.g.  
  `fplot -x .2,.3 -y .3,.6 -p0 -ord ...`

#### Example 3.2. &nbsp; _Charge density contours in Cr_

It is usually more convenient to make scripts for fplot, especially when the figure is complex.
This figure shows a contour plot of the charge density of the Cr charge density in (100), (011) plane,
with quality almost good enough for publication in a journal.

To make this plot you will need to copy [this charge density file](../../../assets/download/inputfiles/chgd.cr) to your working directory,
and cut and paste the script in the box below to _plot.cr_{: style="color: green"}.

~~~
fplot
  -frme 0,0.5,0,sqrt(0.5) -tmx '1;0' -tmy '1;0' -noxn -noyn
  -x 0,1 -y 0,1
  -con .045,.055 -lt 2,bold=3,col=.4,0,0 chgd.cr
  -con .065,.075 -lt 3,bold=4,col=0,0,0 chgd.cr
  -font h13
  -lblu 0.17,0.556 cc '45'
  -lblu 0.28,0.355 cc '55'
  -font t14
  -lblu .5,-.02 cd 'Charge density in bcc Chromium (10^\{-3} a.u.)'
~~~

Run **fplot**{: style="color: blue"} with

    $ fplot -f plot.cr

<div onclick="elm = document.getElementById('fig2'); if(elm.style.display == 'none') elm.style.display = 'block'; else elm.style.display = 'none';">Click here to see the figure.</div>
{::nomarkdown}<div style="display:none;padding:0px;" id="fig2">{:/} 
![Example 3.2](https://lordcephei.github.io/assets/img/fplot2.svg)
{::nomarkdown}</div>{:/}

In this example commands are read from script _fplot.cr_{: style="color: green"}.

+ Argument `-f` tells **fplot**{: style="color: blue"} that the next argument
  _fplot.cr_{: style="color: green"} is not a command but a file containing a script.
+ The script file is read through the preprocessor before parsing.  In this case there are no preprocessor directives.
+ Commands inside a script work almost exactly as they do on the command line.   
  However, in scripts you have to use **\\{...}** for curly brackets, since a simple **{...}**
  will interpreted by the preprocessor as expressions.  Curly brackets can specify superscripts and subscripts, Greek, bold, italic and symbol fonts.
+ **fplot**{: style="color: blue"} draws constant-density contours at 0.045 and 0.055 because of `-con .045,.055`.
  By splitting up the four contours into a pair of `-con` commands, distinct colours and line types can be drawn.
+ Data is read from _chgd.cr_{: style="color: green"}, which must contain _xy_ data. **fplot**{: style="color: blue"} must be 
  told how many rows or columns the data has; here it is specified in the first line of _chgd.cr_{: style="color: green"}.
+ Two of the contour values are labelled (`-lblu`) using Helvetica 13pt font; the figure label uses a 14pt Roman font

_____________________________________________________________

### 3. _fplot commands_

... finish ... when reading data from a file

+ Data is read from _chgd.cr_{: style="color: green"}.  It contains 101 rows and 101 columns; but this is not evident from the file itself.
  The script tells **fplot**{: style="color: blue"} that the file contains 101 columns with `nc -101`; it works out the number of rows from
  the file contents.

_____________________________________________________________

### 4. _Other resources_


